<div class="header">
	<img src="{{ manifest.get('icons')['128'] }}" class="icon">
	<h1>{{ manifest.get('name') }}</h1>
	<ul class="nav nav-tabs">
		<li ng-class="{ active: pane === 'overview' }"><a href="#manifest/{{ manifest.id }}">Overview</a></li>
		<li ng-class="{ active: pane === 'documentation' }"><a href="#manifest/{{ manifest.id }}/documentation">Documentation</a></li>
		<li ng-class="{ active: pane === 'tests' }"><a href="#manifest/{{ manifest.id }}/tests">Tests</a></li>
	</ul>
</div>

<div class="tab-pane" ng-if="pane === 'overview'">
	<p class="description">
		{{ manifest.get('description') }}
	</p>
	<table class="table">
		<tbody>
			<tr><th>ID</th><td>{{ manifest.id }}</td></tr>
			<tr><th>Version</th><td>{{ manifest.get('version') }}</td></tr>
			<tr><th>Authors</th><td>
				<div ng-repeat="author in manifest.get('author')">{{ author.name }}</div>
			</td></tr>
		</tbody>
	</table>
</div>

<div class="tab-pane" ng-if="pane === 'documentation'">
	<nav class="navbar navbar-default navbar-static-top" role="navigation">
		<form class="navbar-form navbar-left" ng-if="manifest.documentation">
			<button type="button" class="btn btn-default" ng-click="manifest.documentation.build()">Build</button>
			<button type="button" class="btn btn-default" ng-if="manifest.documentation.get('built')" ng-click="">View standalone</button>
		</form>
		<p class="navbar-text navbar-right" ng-if="manifest.documentation.get('built')">Last built on</p>
	</nav>
	<div ng-if="!manifest.documentation">
		<p class="description">No documentation has been provided.</div>
	</div>
	<div ng-if="manifest.documentation">
		<div ng-if="!manifest.documentation.get('built')">
			<p class="description">Documentation needs to be built.</div>
		</div>
		<div ng-if="manifest.documentation.get('built')">
			<iframe src="manifest.documentation.url"></iframe>
		</div>
	</div>
</div>

<div class="tab-pane" ng-if="pane === 'tests'">
	<div ng-if="!manifest.tests">
		No tests has been provided
	</div>
	<div ng-if="manifest.tests">
		<div class="docs-toolbar">
			<button type="button" ng-click="manifest.tests.run()">Build</button>
		</div>
		<div ng-if="!manifest.tests.results">
			Tests needs to be run.
		</div>
		<div ng-if="manifest.tests.results">
			<table class="table">
				<tbody>
					<tr><th>Browser</th><td>{{manifest.tests.result.name}} ({{manifest.tests.result.name}})</td></tr>
					<tr><th>Tests</th><td>{{manifest.tests.result.tests}}</td></tr>
					<tr><th>Errors</th><td>{{manifest.tests.result.errors}}</td></tr>
					<tr><th>Failures</th><td>{{manifest.tests.result.failures}}</td></tr>
					<tr><th>Timestamp</th><td>{{manifest.tests.result.timestamp}}</td></tr>
					<tr><th>Time</th><td>{{manifest.tests.result.time}}</td></tr>
				</tbody>
			</table>
			<h3>Results</h3>
			<label><input type="checkbox" selected="selected" ng-model="onlyfailures">Only show failures</label>
			<table class="table">
				<thead>
					<tr><th>Name</th><th>Passed</th><th>Time</th></tr>
				</thead>
					<tbody ng-repeat="testcase in manifest.tests.result.testcases | filter: { failed: onlyfailures ? true : undefined }">
						<tr ng-class="{testfail:testcase.failure}">
							<td><b>{{testcase.name}}</b> - {{testcase.classname}}</td>
							<td>{{testcase.passed}}</td>
							<td>{{testcase.time}}</td>
						</tr>
						<tr ng-if="testcase.failure">
							<td colspan="3" class="testfail">
								{{testcase.failure}}
							</td>
						</tr>
					</tbody>
			</table>
		</div>
	</div>
</div>